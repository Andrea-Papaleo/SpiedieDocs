<!DOCTYPE html>
 
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GPU on Spiedie (CUDA) | Spiedie | Binghamton University</title>
    <link rel="shortcut icon" href="http://localhost:4000/assets/images/favicon.ico" />

    <link rel="stylesheet" href="http://localhost:4000/assets/css/pygments.css" />
    <link rel="stylesheet" href="http://localhost:4000/assets/css/bingfont.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
      integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="http://localhost:4000/assets/css/default.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css"> -->
    <!--<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-11743206-2');
    </script>-->

  </head>
  <body>
    
    <div class="page-container">
      <nav class="navbar">
        <div class="navbar-container">
          <a class="navbar-brand" href="http://localhost:4000"
            ><i class="bu bu-b" style="font-size: 24px"></i>&nbsp;&nbsp; Spiedie
            Docs</a
          >
          <div class="navbar-toc-toggle">
            <button class="navbar-toc-toggle-button">
              <i class="fas fa-bars"></i>
            </button>
          </div>
          <ul class="navbar-menu">
            <li class="navbar-item">
              <a class="navbar-link" href="http://localhost:4000/docs">Docs</a>
            </li>
            <li class="navbar-item">
              <a class="navbar-link" href="http://localhost:4000/singularity"
                >Singularity</a
              >
            </li>
          </ul>
        </div>
        <div class="navbar-toc no-scroll-bar hidden" onclick="openNavbarToc();">
          

    <ol class="toc-l1"><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Introduction to Spiedie</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/introduction.html" >What ia a Cluster</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="https://www.binghamton.edu/watson/facilities/computing/high-performance.html" target="_blank">What is Spiedie</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="https://www.binghamton.edu/watson/facilities/computing/high-performance.html" target="_blank">How do I get an account</a>
                    
                
                
                    
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Getting Started</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/connect-to-spiedie.html" >Connecting to Spiedie</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/home-directory.html" >User Home Directory</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/data_transfer.html" >Transferring Data to the Cluster</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/viewing-spiedie-resources.html" >Viewing Spiedie Resources</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/submitting_jobs.html" >Running Jobs</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/spiedie_modules.html" >Spiedie Modules</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/compilers.html" >Compiling Code On Spiedie</a>
                    
                
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Tutorials</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/python-environment.html" >Setting up a Python Environment</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/quick_start.html" >Quick Start (Python)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_MPI.html" >MPI on Spiedie (C/MPI)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_openmp_multi_core.html" >Multi-Core Processing (C++/OpenMP)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_gpu_compute.html" >GPU on Spiedie (CUDA)</a>
                    
                
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Documentation</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/basic_linux_commands.html" >Basic Linux Commands</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/basic_slurm_commands.html" >Basic SLURM Commands</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/spiedie_partitions.html" >Spiedie Partitions and Features</a>
                    
                
                
                    
                
                </li></ol>
        
        </li></ol>


        </div>
      </nav>

      <div class="content-container">
        <aside class="sidenav">
          <div class="sidenav-container">
            <div class="sidenav-search">
              <form class="search-bar">
                <input
                  type="text"
                  class="form-control docs_search"
                  placeholder="Search Docs"
                />
              </form>
            </div>
            <div class="sidenav-menu no-scroll-bar">
              

    <ol class="toc-l1"><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Introduction to Spiedie</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/introduction.html" >What ia a Cluster</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="https://www.binghamton.edu/watson/facilities/computing/high-performance.html" target="_blank">What is Spiedie</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="https://www.binghamton.edu/watson/facilities/computing/high-performance.html" target="_blank">How do I get an account</a>
                    
                
                
                    
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Getting Started</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/connect-to-spiedie.html" >Connecting to Spiedie</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/home-directory.html" >User Home Directory</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/data_transfer.html" >Transferring Data to the Cluster</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/viewing-spiedie-resources.html" >Viewing Spiedie Resources</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/submitting_jobs.html" >Running Jobs</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/spiedie_modules.html" >Spiedie Modules</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/compilers.html" >Compiling Code On Spiedie</a>
                    
                
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Tutorials</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/python-environment.html" >Setting up a Python Environment</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/quick_start.html" >Quick Start (Python)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_MPI.html" >MPI on Spiedie (C/MPI)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_openmp_multi_core.html" >Multi-Core Processing (C++/OpenMP)</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/tutorials/spiedie_gpu_compute.html" >GPU on Spiedie (CUDA)</a>
                    
                
                
                </li></ol>
        
        </li><li class="toc-item toc-l1-item">
        <h3 class="toc-l1-title">Documentation</h3>
        
            <ol class="sub-toc toc-l2"><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/basic_linux_commands.html" >Basic Linux Commands</a>
                    
                
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/basic_slurm_commands.html" >Basic SLURM Commands</a>
                    
                
                
                    
                
                </li><li class=" toc-item toc-l2-item">
                    
                    
                        <a class="toc-link toc-l2-link" href="http://localhost:4000/docs/spiedie_partitions.html" >Spiedie Partitions and Features</a>
                    
                
                
                    
                
                </li></ol>
        
        </li></ol>


            </div>
          </div>
        </aside>
        <main>
          <section class="docs no-scroll-bar"><div class="docs-nav">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <a id="prev-doc" href=/tutorials/spiedie_openmp_multi_core.html><strong><<</strong> Multi-Core Processing (C++/OpenMP)</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </div><h1>
               GPU on Spiedie (CUDA) 
            </h1>
            
            <article >
              <p>In this tutorial, we will be running the BLAS sample test on a GPU compute node on Spiedie.</p>

<p>Covered in this guide:</p>

<ol>
  <li><a href="../docs/submitting_jobs.html">Writing batch script and using sbatch</a></li>
  <li><a href="../docs/spiedie_modules.html">Loading modules on Spiedie</a></li>
  <li><a href="../docs/spiedie_partitions.html">Requesting specific partitions</a></li>
</ol>

<h2 id="using-sbatch-and-writing-a-batch-script">Using sbatch and writing a batch script</h2>

<p>In this tutorial, we will be using a batch script to submit our job to Spiedie and we will be using the sbatch command. For more examples on submitting jobs, <a href="../docs/submitting_jobs.html">click here</a></p>

<p>We will be using the BLAS and CUDA to run a general matrix-matrix multiplication (GEMM) test code available from Nvidia for this example. GEMM operations are fundamental for many scientific, engineering and deep learning applications and are well suited for GPU-based programming.</p>

<p>You can download the source code for this tutorial <a href="code/simpleCUBLAS.cpp" download="">here</a>.</p>

<p>For more CUDA examples checkout <a href="https://github.com/NVIDIA/cuda-samples" target="_blank"> this repository</a></p>

<h3 id="-set-up-the-environment"><a name="environment_setup"></a> Set up the Environment</h3>

<p>Similar to the previous tutorials, its best to keep our file system organized, so lets create a new directory called <em>CUDA-tutorial</em>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>spiedie81 ~]<span class="nv">$ </span><span class="nb">mkdir </span>CUDA-tutorial
</code></pre></div></div>

<p>Now exit out of spiedie or open a new terminal window on your local machine. If you haven’t downloaded the <em>simpleCUBLAS.cpp</em> file yet, do so now. Once you have the <em>simpleCUBLAS.cpp</em> file, secure copy it to your new folder in spiedie.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scp path/to/mpi.c &lt;username&gt;@spiedie.binghamton.edu:CUDA-tutorial
</code></pre></div></div>

<p>Back in your spiedie terminal you can verify you have the file in the right place by changing into to <em>CUDA-tutorial</em> directory and using <code class="language-plaintext highlighter-rouge">ls</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>spiedie81 ~]<span class="nv">$ </span><span class="nb">cd </span>CUDA-tutorial/
<span class="o">[</span>spiedie81 CUDA-tutorial]<span class="nv">$ </span><span class="nb">ls
</span>simpleCUBLAS.cpp
</code></pre></div></div>

<p>You can use <code class="language-plaintext highlighter-rouge">cat</code> or a text editor to view the contents of <em>simpleCUBLAS.cpp</em>.</p>

<p>Once the source code is uploaded, we can write the batch script to submit our job request.</p>

<h2 id="-creating-the-run-script-for-cuda"><a name="cuda_sbatch"></a> Creating the Run Script for CUDA</h2>

<p>Create a new file in the same directory called, cuda_blas_test.sh.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>spiedie81 CUDA-tutorial]<span class="nv">$ </span>emacs cuda_blas_test.sh
</code></pre></div></div>

<p>The first line in the batch script must be the shebang. So we must have,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin.bash</span>
</code></pre></div></div>

<h4 id="resource-allocation">Resource Allocation</h4>

<p>Next, we will name our job so we are able to monitor it if we wish to on the slurm queue. To assign a job name use <code class="language-plaintext highlighter-rouge">--job-name</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
</code></pre></div></div>

<p>Next, we will assign output file to log all the standard output from our program.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
</code></pre></div></div>

<p>Next, we must request the correct partition for our program to properly run and have access to the P100 gpus available on Spiedie. We therefore request the gpucompute partition with the <code class="language-plaintext highlighter-rouge">--partition</code> option:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
</code></pre></div></div>
<p>We can use the default number of nodes (1) and default memory for this program.</p>

<p>We need to let SLURM know how many tasks we will require for our program. Since we will not be using any parallel CPU computation, we will only request one.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
</code></pre></div></div>
<p>Finally, we should also let SLURM know how many GPUs we will require for our program. In this instance we are requesting 1 GPU.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>
</code></pre></div></div>

<p>We’ve finished defining our resource allocation parameters for our job.</p>

<h4 id="loading-modules">Loading modules</h4>

<p>Next we must make sure we have the necessary drivers and tools to run our CUDA code. To load the correct modules, we must add the following lines to our shell script.</p>

<p>First we must load the CUDA toolkit, which includes the CUDA compiler.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
</code></pre></div></div>

<p><strong><em>Note: We will be CUDA10.0 for this tutorial</em></strong></p>

<p>Since we are using the CUDA-enabled BLAS library, we must also load it.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
module load cuda10.0/toolkit/10.0.130
</code></pre></div></div>

<p>We are now ready to write the commands to compile, link, and execute the program using <code class="language-plaintext highlighter-rouge">nvcc</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
module load cuda10.0/toolkit/10.0.130
nvcc simpleCUBLAS.cpp <span class="nt">-c</span> simpleCUBLAS.o
</code></pre></div></div>

<p>To link object code with the CUBLAS library, add <code class="language-plaintext highlighter-rouge">nvcc simpleCUBLAS.o -o simpleCUBLAS -lcublas</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
module load cuda10.0/toolkit/10.0.130
nvcc simpleCUBLAS.cpp <span class="nt">-c</span> simpleCUBLAS.o
nvcc simpleCUBLAS.o <span class="nt">-o</span> simpleCUBLAS <span class="nt">-lcublas</span>
</code></pre></div></div>

<p>Finally, we can run the program by adding <code class="language-plaintext highlighter-rouge">./simpleCUBLAS</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
module load cuda10.0/toolkit/10.0.130
nvcc simpleCUBLAS.cpp <span class="nt">-c</span> simpleCUBLAS.o
nvcc simpleCUBLAS.o <span class="nt">-o</span> simpleCUBLAS <span class="nt">-lcublas</span>
./simpleCUBLAS
</code></pre></div></div>

<h2 id="submitting-using-sbatch">Submitting using SBATCH</h2>

<p>The final cuda_blas_test.sh file should be:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH --job-name=CUBLASTEST</span>
<span class="c">#SBATCH --output=cuda_output.log</span>
<span class="c">#</span>
<span class="c">#SBATCH --partition=gpucompute</span>
<span class="c">#SBATCH --ntasks=1</span>
<span class="c">#SBATCH --gres=gpu:1</span>

module load cuda10.0/blas/10.0.130
module load cuda10.0/toolkit/10.0.130
nvcc simpleCUBLAS.cpp <span class="nt">-c</span> simpleCUBLAS.o
nvcc simpleCUBLAS.o <span class="nt">-o</span> simpleCUBLAS <span class="nt">-lcublas</span>
./simpleCUBLAS
</code></pre></div></div>

<p>Click <a href="code/cuda_blas_test.sh" download="">here</a> to download the complete batch file.</p>

<p>Since, our parameters are specified in the shell script, we just need to submit the shell script with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>spiedie81 CUDA-tutorial]<span class="nv">$ </span>sbatch cuda_blas_test.sh 
</code></pre></div></div>

<p>The job should be queued and the results should be output in the cuda_output.log file once the job has been assigned and finished.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>spiedie81 CUDA-tutorial]<span class="nv">$ </span><span class="nb">cat </span>cuda_output.log 
GPU Device 0: <span class="s2">"Tesla P100-PCIE-12GB"</span> with compute capability 6.0

simpleCUBLAS <span class="nb">test </span>running..
simpleCUBLAS <span class="nb">test </span>passed.
<span class="o">[</span>spiedie81 CUDA-tutorial]<span class="nv">$ </span>
</code></pre></div></div>


            </article><div class="docs-nav">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <a id="prev-doc" href=/tutorials/spiedie_openmp_multi_core.html><strong><<</strong> Multi-Core Processing (C++/OpenMP)</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </div></section>
        </main>
        <aside class="content-detail">
          <!-- Begin Tags -->
          <div class="content-tags-container">
    <h3 class="content-tags-title">Tags</h3>
    <ul class="content-tags-list">
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#cuda">
            CUDA
        </a>
        </li>
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#cublas">
            CUBLAS
        </a>
        </li>
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#gpu">
            GPU
        </a>
        </li>
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#blas">
            BLAS
        </a>
        </li>
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#gemm">
            GEMM
        </a>
        </li>
    
        <li class="content-tag">
        <a class="content-tag-link" href="http://localhost:4000/tags#sbatch">
            SBATCH
        </a>
        </li>
    
    </ul>
</div>
          <!-- End Tags -->
        </aside>  
      </div>
      <footer class="row">
        <script src="http://localhost:4000/assets/js/sidenavToggle.js"></script>
        <div class="col-sm-12">
          <!-- Footer -->
        </div>
      </footer>
    </div>
    <script
      src="https://code.jquery.com/jquery-2.2.4.min.js"
      integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script src="http://localhost:4000/assets/js/jquery.autocomplete.js"></script>
    <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script> -->
    <script>
      var docs_arr = [
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          {
            "url":`/tutorials/`,
            "value": `Tutorials` 
          },
        
      
        
      
        
      
        
      
        
          {
            "url":`/tutorials/python-environment.html`,
            "value": `Setting Up a Python Environment` 
          },
        
      
        
          {
            "url":`/tutorials/quick_start.html`,
            "value": `Quick Start Tutorial - Python` 
          },
        
      
        
      
        
      
        
          {
            "url":`/tutorials/spiedie_MPI.html`,
            "value": `MPI on Spiedie (C/MPI)` 
          },
        
      
        
          {
            "url":`/tutorials/spiedie_conda.html`,
            "value": `Conda on Spiedie (intermediate)` 
          },
        
      
        
      
        
          {
            "url":`/tutorials/spiedie_gpu_compute.html`,
            "value": `GPU on Spiedie (CUDA)` 
          },
        
      
        
      
        
      
        
          {
            "url":`/tutorials/spiedie_multiprocessing.html`,
            "value": `Python Multi-Core Tutorial` 
          },
        
      
        
          {
            "url":`/tutorials/spiedie_openmp_multi_core.html`,
            "value": `Multi-Core Processing (C++/OpenMP)` 
          },
        
      
        
      
        
          {
            "url":`/tutorials/spiedie_singularity.html`,
            "value": `Singularity Containers on Spiedie (advanced)` 
          },
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
        {
          "url":`/tags#blas`,
          "value":`BLAS`
        },
      
        {
          "url":`/tags#clang`,
          "value":`CLANG`
        },
      
        {
          "url":`/tags#cmake`,
          "value":`CMAKE`
        },
      
        {
          "url":`/tags#cublas`,
          "value":`CUBLAS`
        },
      
        {
          "url":`/tags#cuda`,
          "value":`CUDA`
        },
      
        {
          "url":`/tags#check-job-status`,
          "value":`Check Job Status`
        },
      
        {
          "url":`/tags#cloud-storage`,
          "value":`Cloud Storage`
        },
      
        {
          "url":`/tags#conda`,
          "value":`Conda`
        },
      
        {
          "url":`/tags#configuration`,
          "value":`Configuration`
        },
      
        {
          "url":`/tags#containers`,
          "value":`Containers`
        },
      
        {
          "url":`/tags#create-images`,
          "value":`Create Images`
        },
      
        {
          "url":`/tags#faq`,
          "value":`FAQ`
        },
      
        {
          "url":`/tags#file-transfer`,
          "value":`File Transfer`
        },
      
        {
          "url":`/tags#forwarding`,
          "value":`Forwarding`
        },
      
        {
          "url":`/tags#gcc`,
          "value":`GCC`
        },
      
        {
          "url":`/tags#gemm`,
          "value":`GEMM`
        },
      
        {
          "url":`/tags#gpu`,
          "value":`GPU`
        },
      
        {
          "url":`/tags#gpucompute`,
          "value":`GPUCompute`
        },
      
        {
          "url":`/tags#gui`,
          "value":`GUI`
        },
      
        {
          "url":`/tags#icc`,
          "value":`ICC`
        },
      
        {
          "url":`/tags#intel-compilers`,
          "value":`Intel Compilers`
        },
      
        {
          "url":`/tags#interactive-sessions`,
          "value":`Interactive Sessions`
        },
      
        {
          "url":`/tags#job-submission`,
          "value":`Job Submission`
        },
      
        {
          "url":`/tags#linux`,
          "value":`Linux`
        },
      
        {
          "url":`/tags#login`,
          "value":`Login`
        },
      
        {
          "url":`/tags#matlab`,
          "value":`MATLAB`
        },
      
        {
          "url":`/tags#mvapich2`,
          "value":`MVAPICH2`
        },
      
        {
          "url":`/tags#mac`,
          "value":`Mac`
        },
      
        {
          "url":`/tags#modules`,
          "value":`Modules`
        },
      
        {
          "url":`/tags#multiprocessing`,
          "value":`Multiprocessing`
        },
      
        {
          "url":`/tags#new-user`,
          "value":`New_User`
        },
      
        {
          "url":`/tags#python`,
          "value":`Python`
        },
      
        {
          "url":`/tags#python-program`,
          "value":`Python Program`
        },
      
        {
          "url":`/tags#remote-access`,
          "value":`Remote Access`
        },
      
        {
          "url":`/tags#remote-build`,
          "value":`Remote Build`
        },
      
        {
          "url":`/tags#run-program`,
          "value":`Run Program`
        },
      
        {
          "url":`/tags#sbatch`,
          "value":`SBATCH`
        },
      
        {
          "url":`/tags#slurm`,
          "value":`SLURM`
        },
      
        {
          "url":`/tags#srun`,
          "value":`SRUN`
        },
      
        {
          "url":`/tags#setup`,
          "value":`Setup`
        },
      
        {
          "url":`/tags#singularity`,
          "value":`Singularity`
        },
      
        {
          "url":`/tags#submit-job`,
          "value":`Submit Job`
        },
      
        {
          "url":`/tags#submit-job`,
          "value":`Submit job`
        },
      
        {
          "url":`/tags#sylabs-cloud-services`,
          "value":`Sylabs Cloud Services`
        },
      
        {
          "url":`/tags#tensorflow`,
          "value":`Tensorflow`
        },
      
        {
          "url":`/tags#tensorflow-gpu`,
          "value":`Tensorflow-GPU`
        },
      
        {
          "url":`/tags#tutorial`,
          "value":`Tutorial`
        },
      
        {
          "url":`/tags#virtualenv`,
          "value":`VirtualEnv`
        },
      
        {
          "url":`/tags#windows`,
          "value":`Windows`
        },
      
        {
          "url":`/tags#workflow`,
          "value":`Workflow`
        },
      
        {
          "url":`/tags#x11`,
          "value":`X11`
        },
      
        {
          "url":`/tags#containers`,
          "value":`containers`
        },
      
        {
          "url":`/tags#create-image`,
          "value":`create image`
        },
      
        {
          "url":`/tags#custom-container`,
          "value":`custom container`
        },
      
        {
          "url":`/tags#docs`,
          "value":`docs`
        },
      
        {
          "url":`/tags#features`,
          "value":`features`
        },
      
        {
          "url":`/tags#interactive-session`,
          "value":`interactive session`
        },
      
        {
          "url":`/tags#memory-allocation`,
          "value":`memory allocation`
        },
      
        {
          "url":`/tags#memory-management`,
          "value":`memory management`
        },
      
        {
          "url":`/tags#modules`,
          "value":`modules`
        },
      
        {
          "url":`/tags#mpi`,
          "value":`mpi`
        },
      
        {
          "url":`/tags#multicore`,
          "value":`multicore`
        },
      
        {
          "url":`/tags#multinode`,
          "value":`multinode`
        },
      
        {
          "url":`/tags#partitions`,
          "value":`partitions`
        },
      
        {
          "url":`/tags#sacct`,
          "value":`sacct`
        },
      
        {
          "url":`/tags#sbatch`,
          "value":`sbatch`
        },
      
        {
          "url":`/tags#sinfo`,
          "value":`sinfo`
        },
      
        {
          "url":`/tags#singularity`,
          "value":`singularity`
        },
      
        {
          "url":`/tags#singularity-definition-files`,
          "value":`singularity definition files`
        },
      
        {
          "url":`/tags#singularity-exec`,
          "value":`singularity exec`
        },
      
        {
          "url":`/tags#singularity-recipes`,
          "value":`singularity recipes`
        },
      
        {
          "url":`/tags#singularity-run`,
          "value":`singularity run`
        },
      
        {
          "url":`/tags#srun`,
          "value":`srun`
        },
      
        {
          "url":`/tags#tutorial`,
          "value":`tutorial`
        },
      
        {
          "url":`/tags#tutorials`,
          "value":`tutorials`
        },
      
        {
          "url":`/tags#virtual-environment`,
          "value":`virtual environment`
        },
      
        {
          "url":`/tags#x2go`,
          "value":`x2go`
        },
      
      ];
      $('.docs_search').autocomplete({
          lookup: docs_arr,
          onSelect: function (suggestion) {
              window.location = "http://localhost:4000"+suggestion.url
          }
      });
    </script>
  </body>
</html>
